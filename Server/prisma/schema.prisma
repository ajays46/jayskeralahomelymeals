generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model Auth {
  id          String   @id @default(uuid()) @db.VarChar(36)
  email       String   @unique @db.VarChar(255)
  password    String   @db.VarChar(255)
  phoneNumber String?  @map("phone_number") @db.VarChar(255)
  apiKey      String   @map("api_key") @db.VarChar(255)
  status      Status   @default(ACTIVE)
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  user        User?

  @@map("auths")
}

model User {
  id                String             @id @default(uuid()) @db.VarChar(36)
  authId            String             @unique @map("auth_id") @db.VarChar(36)
  status            UserStatus         @default(ACTIVE)
  createdAt         DateTime           @default(now()) @map("created_at")
  updatedAt         DateTime           @default(now()) @updatedAt @map("updated_at")
  createdBy         String?            @map("created_by") @db.VarChar(36)
  companyId         String?            @map("company_id") @db.VarChar(36)
  auth              Auth?              @relation(fields: [authId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  company           Company?           @relation(fields: [companyId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  userRoles         UserRole[]
  addresses         Address[]
  deliveryItems     DeliveryItem[]
  contacts          Contact[]
  payments          Payment[]
  paymentReceipts   PaymentReceipt[]
  orders            Order[]
  deliveryExecutive DeliveryExecutive?

  @@map("users")
}

model Address {
  id            String         @id @default(uuid()) @db.VarChar(36)
  userId        String         @map("user_id") @db.VarChar(36)
  street        String         @db.VarChar(255)
  housename     String         @db.VarChar(255)
  city          String         @db.VarChar(255)
  pincode       Int
  geoLocation   String?        @map("geo_location") @db.VarChar(255)
  addressType   AddressType    @default(HOME) @map("address_type")
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @updatedAt @map("updated_at")
  googleMapsUrl String?        @map("google_maps_url") @db.VarChar(500)
  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  orders        Order[]
  deliveryItems DeliveryItem[]

  @@map("addresses")
}

model UserRole {
  userId    String          @map("user_id") @db.VarChar(36)
  name      user_roles_name
  createdAt DateTime        @default(now()) @map("created_at")
  updatedAt DateTime        @updatedAt @map("updated_at")
  id        String          @id @default(uuid()) @db.VarChar(36)
  user      User            @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@unique([userId, name])
  @@map("user_roles")
}

model Company {
  id                String            @id @default(uuid())
  name              String
  address_id        String
  created_at        DateTime          @default(now())
  updated_at        DateTime          @updatedAt
  users             User[]
  products          Product[]
  menus             Menu[]
  productCategories ProductCategory[]
  menuCategories    MenuCategory[]
  menuItemPrices    MenuItemPrice[]

  @@map("company")
}

model Product {
  id          String            @id @default(uuid()) @db.VarChar(36)
  companyId   String            @map("company_id") @db.VarChar(36)
  imageUrl    String?           @map("image_url") @db.Text
  code        String            @unique @db.VarChar(255)
  productName String            @map("product_name") @db.VarChar(255)
  status      ProductStatus     @default(ACTIVE)
  createdAt   DateTime          @default(now()) @map("created_at")
  updatedAt   DateTime          @updatedAt @map("updated_at")
  company     Company           @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  prices      ProductPrice[]
  quantities  ProductQuantity[]
  categories  ProductCategory[]
  menuItems   MenuItem[]

  @@map("products")
}

model ProductPrice {
  id        String   @id @default(uuid()) @db.VarChar(36)
  date      DateTime @db.Date
  productId String   @map("product_id") @db.VarChar(36)
  price     Int
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("product_prices")
}

model ProductQuantity {
  id        String   @id @default(uuid()) @db.VarChar(36)
  date      DateTime @db.Date
  productId String   @map("product_id") @db.VarChar(36)
  quantity  Int
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("product_quantities")
}

model MenuItem {
  id            String          @id @default(uuid()) @db.VarChar(36)
  name          String          @db.VarChar(255)
  menuId        String          @map("menu_id") @db.VarChar(36)
  createdAt     DateTime        @default(now()) @map("created_at")
  updatedAt     DateTime        @updatedAt @map("updated_at")
  productId     String?         @map("product_id") @db.VarChar(36)
  menu          Menu            @relation(fields: [menuId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  product       Product?        @relation(fields: [productId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  prices        MenuItemPrice[]
  deliveryItems DeliveryItem[]

  @@map("menu_items")
}

model MenuItemPrice {
  id         String   @id @default(uuid()) @db.VarChar(36)
  companyId  String   @map("company_id") @db.VarChar(36)
  menuItemId String   @map("menu_item_id") @db.VarChar(36)
  totalPrice Int      @map("total_price")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")
  company    Company  @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  menuItem   MenuItem @relation(fields: [menuItemId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("menu_item_prices")
}

model MenuCategory {
  id          String   @id @default(uuid()) @db.VarChar(36)
  companyId   String   @map("company_id") @db.VarChar(36)
  menuId      String   @map("menu_id") @db.VarChar(36)
  name        String   @db.VarChar(255)
  description String   @db.Text
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  menu        Menu     @relation(fields: [menuId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("menu_categories")
}

model Menu {
  id             String         @id @default(uuid()) @db.VarChar(36)
  companyId      String         @map("company_id") @db.VarChar(36)
  name           String         @db.VarChar(255)
  status         MenuStatus     @default(ACTIVE)
  createdAt      DateTime       @default(now()) @map("created_at")
  updatedAt      DateTime       @updatedAt @map("updated_at")
  company        Company        @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  menuItems      MenuItem[]
  menuCategories MenuCategory[]

  @@map("menus")
}

model ProductCategory {
  id                  String   @id @default(uuid()) @db.VarChar(36)
  companyId           String   @map("company_id") @db.VarChar(36)
  productId           String   @map("product_id") @db.VarChar(36)
  productCategoryName String   @map("product_category_name") @db.VarChar(255)
  description         String   @db.Text
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")
  company             Company  @relation(fields: [companyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  product             Product  @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("product_categories")
}

model Order {
  id                     String         @id @default(uuid()) @db.VarChar(36)
  userId                 String         @map("user_id") @db.VarChar(36)
  linkedRecurringOrderId String?        @map("linked_recurring_order_id") @db.VarChar(36)
  orderDate              DateTime       @map("order_date") @db.Date
  status                 OrderStatus    @default(Pending)
  orderTimes             String         @map("order_times")
  totalPrice             Int            @map("total_price")
  deliveryAddressId      String?        @map("delivery_address_id") @db.VarChar(36)
  createdAt              DateTime       @default(now()) @map("created_at")
  updatedAt              DateTime       @updatedAt @map("updated_at")
  deliveryAddress        Address?       @relation(fields: [deliveryAddressId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  deliveryItems          DeliveryItem[]
  payments               Payment[]
  user                   User           @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("orders")
}

model DeliveryItem {
  id               String                            @id @default(uuid()) @db.VarChar(36)
  orderId          String                            @map("order_id") @db.VarChar(36)
  menuItemId       String                            @map("menu_item_id") @db.VarChar(36)
  quantity         Int
  deliveryDate     DateTime                          @map("delivery_date") @db.Date
  deliveryTimeSlot delivery_items_delivery_time_slot @map("delivery_time_slot")
  addressId        String                            @map("address_id") @db.VarChar(36)
  status           OrderStatus                       @default(Pending)
  createdAt        DateTime                          @default(now()) @map("created_at")
  updatedAt        DateTime                          @updatedAt @map("updated_at")
  userId           String                            @map("user_id") @db.VarChar(36)
  order            Order                             @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  user             User                              @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  menuItem         MenuItem                          @relation(fields: [menuItemId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  deliveryAddress  Address                           @relation(fields: [addressId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("delivery_items")
}

model Contact {
  id              String        @id @default(uuid()) @db.VarChar(36)
  userId          String        @map("user_id") @db.VarChar(36)
  firstName       String        @map("first_name") @db.VarChar(255)
  lastName        String        @map("last_name") @db.VarChar(255)
  instagramHandle String?       @map("instagram_handle") @db.VarChar(255)
  whatsappNumber  String?       @map("whatsapp_number") @db.VarChar(255)
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  phoneNumbers    PhoneNumber[]

  @@map("contacts")
}

model PhoneNumber {
  id        String   @id @default(uuid()) @db.VarChar(36)
  contactId String   @map("contact_id") @db.VarChar(36)
  type      String   @db.VarChar(50)
  number    String   @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  contact   Contact  @relation(fields: [contactId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("phone_numbers")
}

model Payment {
  id                  String           @id @default(uuid()) @db.VarChar(36)
  userId              String           @map("user_id") @db.VarChar(36)
  orderId             String           @map("order_id") @db.VarChar(36)
  paymentMethod       PaymentMethod    @map("payment_method")
  paymentStatus       PaymentStatus    @default(Pending) @map("payment_status")
  paymentAmount       Int              @map("payment_amount")
  paymentDate         DateTime?        @map("payment_date")
  receiptUrl          String?          @map("receipt_url") @db.VarChar(500)
  uploadedReceiptType ReceiptType?     @map("uploaded_receipt_type")
  createdAt           DateTime         @default(now()) @map("created_at")
  updatedAt           DateTime         @updatedAt @map("updated_at")
  externalReceiptUrl  String?          @map("external_receipt_url") @db.VarChar(500)
  user                User             @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  order               Order            @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  paymentReceipts     PaymentReceipt[]

  @@map("payments")
}

model PaymentReceipt {
  id              String   @id @default(uuid()) @db.VarChar(36)
  userId          String   @map("user_id") @db.VarChar(36)
  paymentId       String   @map("payment_id") @db.VarChar(36)
  receiptImageUrl String   @map("receipt_image_url") @db.VarChar(500)
  receipt         String   @db.VarChar(500)
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  payment         Payment  @relation(fields: [paymentId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("payment_receipts")
}

model delivery_executive_profile {
  user_id             String                   @id @db.VarChar(36)
  license_number      String?                  @db.VarChar(50)
  license_expiry_date DateTime?                @db.Date
  joined_date         DateTime?                @db.Date
  rating              Float?                   @db.Float
  total_routes        Int?
  status              DeliveryExecutiveStatus? @default(ACTIVE)
  created_at          DateTime?                @default(now()) @db.Timestamp(0)

  @@ignore
}

model special_days {
  id          String    @id @db.VarChar(36)
  date        DateTime? @db.Date
  description String?   @db.Text
  school      String?   @db.VarChar(255)
  created_at  DateTime? @default(now()) @db.Timestamp(0)

  @@ignore
}

model traffic_weather_log {
  id            String                             @id @db.VarChar(36)
  user_id       String?                            @db.VarChar(36)
  date          DateTime?                          @db.Date
  weather       String?                            @db.VarChar(100)
  traffic_level traffic_weather_log_traffic_level?
  delay_minutes Float?                             @db.Float
  created_at    DateTime?                          @default(now()) @db.Timestamp(0)

  @@ignore
}

model vehicle_service_log {
  id              String    @id @db.VarChar(36)
  vehicle_id      String?   @db.VarChar(36)
  user_id         String?   @db.VarChar(36)
  service_date    DateTime? @db.Date
  service_details String?   @db.Text
  cost            Float?    @db.Float
  created_at      DateTime? @default(now()) @db.Timestamp(0)

  @@ignore
}

model vehicle_tracking_log {
  id                           String                        @id @db.VarChar(36)
  vehicle_id                   String?                       @db.VarChar(36)
  user_id                      String?                       @db.VarChar(36)
  route_id                     String?                       @db.VarChar(36)
  timestamp                    DateTime?                     @db.DateTime(0)
  time_from_start_minutes      Float?                        @db.Float
  time_since_departure_minutes Float?                        @db.Float
  date                         DateTime?                     @db.Date
  session                      vehicle_tracking_log_session?
  journey_phase                String?                       @db.VarChar(50)
  is_at_stop                   Boolean?                      @default(false)
  current_stop_order           Int?
  latitude                     Float?                        @db.Float
  longitude                    Float?                        @db.Float
  speed                        Float?                        @db.Float
  created_at                   DateTime?                     @default(now()) @db.Timestamp(0)

  @@index([is_at_stop, route_id], map: "idx_tracking_at_stop")
  @@index([date, session], map: "idx_tracking_date_session")
  @@index([journey_phase, route_id], map: "idx_tracking_journey_phase")
  @@index([route_id, date], map: "idx_tracking_route_date")
  @@index([session], map: "idx_tracking_session")
  @@index([route_id, timestamp], map: "idx_vehicle_tracking_route_time")
  @@ignore
}

model vehicles {
  id                  String    @id @db.VarChar(36)
  user_id             String?   @map("user_id") @db.VarChar(36)
  registration_number String?   @map("registration_number") @db.VarChar(50)
  model               String?   @db.VarChar(100)
  purchase_date       DateTime? @map("purchase_date") @db.Date
  insurance_expiry    DateTime? @map("insurance_expiry") @db.Date
  puc_expiry          DateTime? @map("puc_expiry") @db.Date
  fitness_expiry      DateTime? @map("fitness_expiry") @db.Date
  road_tax_expiry     DateTime? @map("road_tax_expiry") @db.Date
  created_at          DateTime? @default(now()) @map("created_at") @db.Timestamp(0)

  @@map("vehicles")
}

model fuel_log {
  id          String    @id @db.VarChar(36)
  vehicle_id  String?   @db.VarChar(36)
  user_id     String?   @db.VarChar(36)
  refuel_date DateTime? @db.Date
  litres      Float?    @db.Float
  cost        Float?    @db.Float
  created_at  DateTime? @default(now()) @db.Timestamp(0)

  @@ignore
}

model planned_route_stops {
  id                                   String                          @id @db.VarChar(36)
  user_id                              String?                         @db.VarChar(36)
  route_id                             String?                         @db.VarChar(36)
  delivery_id                          String?                         @db.VarChar(36)
  start_time                           DateTime?                       @db.DateTime(0)
  depot_departure_time                 DateTime?                       @db.DateTime(0)
  date                                 DateTime                        @db.Date
  session                              planned_route_stops_session
  route_type                           planned_route_stops_route_type? @default(ai_optimized)
  is_best_route                        Boolean?                        @default(false)
  route_rank                           Int?                            @default(0)
  num_drivers                          Int?                            @default(1)
  stop_order                           Int
  delivery_name                        String?                         @db.VarChar(255)
  location                             String?                         @db.VarChar(255)
  latitude                             Float?                          @db.Float
  longitude                            Float?                          @db.Float
  packages                             Int?
  customer_type                        String?                         @default("normal") @db.VarChar(50)
  priority_level                       String?                         @db.VarChar(50)
  distance_from_previous               Float?                          @db.Float
  expected_time_from_previous          Float?                          @db.Float
  time_to_travel_from_previous_minutes Float?                          @db.Float
  cumulative_distance                  Float?                          @db.Float
  cumulative_time                      Float?                          @db.Float
  cumulative_travel_time_minutes       Float?                          @db.Float
  estimated_completion_hours           Float?                          @db.Float
  within_2_hour_constraint             Boolean?                        @default(true)
  depot_latitude                       Float?                          @db.Float
  depot_longitude                      Float?                          @db.Float
  route_comparison_data                Json?
  planned_arrival_time                 DateTime?                       @db.DateTime(0)
  expected_arrival_time                DateTime?                       @db.DateTime(0)
  expected_completion_time             DateTime?                       @db.DateTime(0)
  created_at                           DateTime?                       @default(now()) @db.Timestamp(0)

  @@index([date, session], map: "idx_planned_date_session")
  @@index([delivery_id], map: "idx_planned_route_delivery_id")
  @@index([route_id], map: "idx_planned_route_id")
  @@index([route_id, date, session, route_type, is_best_route, stop_order], map: "idx_planned_route_main")
  @@index([route_type], map: "idx_planned_route_type")
  @@index([user_id], map: "idx_planned_user_id")
  @@ignore
}

model actual_route_stops {
  id                                   String                              @id @db.VarChar(36)
  user_id                              String?                             @db.VarChar(36)
  route_id                             String?                             @db.VarChar(36)
  date                                 DateTime?                           @db.Date
  session                              actual_route_stops_session?
  start_time                           DateTime?                           @db.DateTime(0)
  depot_departure_time                 DateTime?                           @db.DateTime(0)
  planned_stop_id                      String?                             @db.VarChar(36)
  stop_order                           Int?
  delivery_name                        String?                             @db.VarChar(255)
  location                             String?                             @db.VarChar(255)
  latitude                             Float?                              @db.Float
  longitude                            Float?                              @db.Float
  packages_delivered                   Int?
  actual_arrival_time                  DateTime?                           @db.DateTime(0)
  actual_completion_time               DateTime?                           @db.DateTime(0)
  time_spent_at_stop_minutes           Float?                              @db.Float
  actual_distance_from_previous        Float?                              @db.Float
  actual_time_from_previous            Float?                              @db.Float
  cumulative_travel_time_minutes       Float?                              @db.Float
  time_to_travel_from_previous_minutes Float?                              @db.Float
  actual_completion_hours              Float?                              @db.Float
  total_journey_duration_minutes       Float?                              @db.Float
  within_2_hour_constraint             Boolean?
  performance_score                    Float?                              @db.Float
  reward_signal                        Float?                              @db.Float
  learning_data                        Json?
  delivery_status                      actual_route_stops_delivery_status? @default(pending)
  delay_reason                         String?                             @db.Text
  geo_accuracy                         Float?                              @db.Float
  status                               actual_route_stops_status?
  route_type                           actual_route_stops_route_type?

  @@index([performance_score], map: "idx_actual_performance")
  @@index([route_id], map: "idx_actual_route_id")
  @@index([route_id, date, session, route_type, stop_order], map: "idx_actual_route_main")
  @@index([route_type], map: "idx_actual_route_type")
  @@index([user_id], map: "idx_actual_user_id")
  @@ignore
}

model customer_subscriptions {
  customer_id       Int                                   @id
  subscription_type Int
  morning_status    customer_subscriptions_morning_status
  lunch_status      customer_subscriptions_lunch_status
  dinner_status     customer_subscriptions_dinner_status

  @@ignore
}

model manual_review_log {
  id                String    @id @db.VarChar(36)
  table_name        String?   @db.VarChar(255)
  record_id         String?   @db.VarChar(36)
  issue_type        String?   @db.VarChar(255)
  issue_description String?   @db.Text
  old_value         String?   @db.Text
  new_value         String?   @db.Text
  status            String?   @db.VarChar(100)
  reviewed_by       String?   @db.VarChar(36)
  reviewed_at       DateTime? @db.DateTime(0)
  created_at        DateTime? @default(now()) @db.Timestamp(0)

  @@ignore
}

model DeliveryExecutive {
  id        String   @id @default(uuid()) @db.VarChar(36)
  userId    String   @unique @map("user_id") @db.VarChar(36)
  imageUrl  String?  @map("image_url") @db.VarChar(500)
  location  String?  @db.Text
  latitude  Float?   @db.Float
  longitude Float?   @db.Float
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("delivery_executives")
}

model algorithm_performance {
  id                   String    @id @db.VarChar(36)
  algorithm_name       String    @db.VarChar(50)
  delivery_date        DateTime  @db.Date
  delivery_session     String?   @db.VarChar(20)
  num_deliveries       Int?
  num_drivers          Int?
  estimated_time_hours Decimal?  @db.Decimal(5, 2)
  actual_time_hours    Decimal?  @db.Decimal(5, 2)
  total_distance_km    Decimal?  @db.Decimal(8, 2)
  within_constraint    Boolean?
  algorithm_score      Decimal?  @db.Decimal(5, 2)
  was_selected         Boolean?  @default(false)
  characteristics      Json?
  created_at           DateTime? @default(now()) @db.DateTime(0)

  @@index([algorithm_name], map: "idx_algorithm_name")
  @@index([algorithm_score], map: "idx_algorithm_score")
  @@index([delivery_date], map: "idx_delivery_date")
  @@index([was_selected], map: "idx_was_selected")
}

model best_planned_routes {
  id                        String                         @id @db.VarChar(36)
  date                      DateTime                       @db.Date
  session                   best_planned_routes_session
  route_type                best_planned_routes_route_type
  route_id                  String                         @db.VarChar(36)
  driver_id                 String?                        @db.VarChar(36)
  total_distance_km         Float?                         @db.Float
  total_time_minutes        Float?                         @db.Float
  num_stops                 Int?
  num_drivers               Int?
  within_2_hour_constraint  Boolean?                       @default(false)
  selection_reason          String?                        @db.VarChar(255)
  comparison_score          Float?                         @db.Float
  ai_score                  Float?                         @db.Float
  main_branch_score         Float?                         @db.Float
  compared_with_route_types String?                        @db.Text
  comparison_details        Json?
  created_at                DateTime?                      @default(now()) @db.Timestamp(0)
  updated_at                DateTime?                      @default(now()) @db.Timestamp(0)

  @@unique([date, session, route_type], map: "unique_date_session_type")
  @@index([date, session], map: "idx_date_session")
  @@index([route_id], map: "idx_route_id")
  @@index([route_type], map: "idx_route_type")
}

model deliveries {
  ID               Int      @id @default(autoincrement())
  Date             DateTime @db.Date
  Delivery_Name    String   @db.VarChar(100)
  Location         String?  @db.VarChar(150)
  Packages         Int?     @default(0)
  Final_Latitude   Decimal? @db.Decimal(10, 6)
  Final_Longitude  Decimal? @db.Decimal(10, 6)
  Coords           String?  @db.VarChar(100)
  Distance_Diff_km Decimal? @db.Decimal(10, 2)
}

model delivery_zone_assignments {
  id          String    @id @db.VarChar(36)
  delivery_id String    @db.VarChar(36)
  zone_code   String?   @db.VarChar(50)
  assigned_at DateTime? @default(now()) @db.DateTime(0)

  @@index([assigned_at], map: "idx_assigned_at")
  @@index([delivery_id], map: "idx_delivery_id")
  @@index([zone_code], map: "idx_zone_code")
}

model delivery_zone_polygons {
  id          String  @id @db.VarChar(36)
  zone_code   String  @db.VarChar(50)
  point_order Int
  latitude    Decimal @db.Decimal(10, 8)
  longitude   Decimal @db.Decimal(10, 8)

  @@index([zone_code], map: "idx_zone_code")
  @@index([zone_code, point_order], map: "idx_zone_points")
}

model delivery_zones {
  id                   String                   @id @db.VarChar(36)
  zone_code            String                   @unique(map: "zone_code") @db.VarChar(50)
  zone_name            String                   @db.VarChar(255)
  zone_type            delivery_zones_zone_type
  zone_polygon         Unsupported("geometry")?
  center_latitude      Decimal?                 @db.Decimal(10, 8)
  center_longitude     Decimal?                 @db.Decimal(10, 8)
  radius_km            Decimal?                 @db.Decimal(8, 2)
  priority_weight      Decimal?                 @default(0.50) @db.Decimal(3, 2)
  peak_priority_weight Decimal?                 @default(0.50) @db.Decimal(3, 2)
  peak_hours_start     DateTime?                @db.Time(0)
  peak_hours_end       DateTime?                @db.Time(0)
  peak_days_of_week    String?                  @default("1,2,3,4,5") @db.VarChar(20)
  normal_speed_kmh     Int?                     @default(30)
  peak_speed_kmh       Int?                     @default(18)
  description          String?                  @db.Text
  is_active            Boolean?                 @default(true)
  created_at           DateTime?                @default(now()) @db.DateTime(0)
  updated_at           DateTime?                @default(now()) @db.DateTime(0)

  @@index([is_active], map: "idx_is_active")
  @@index([zone_code], map: "idx_zone_code")
  @@index([zone_type], map: "idx_zone_type")
}

model route_comparisons {
  id                  String                           @id @db.VarChar(36)
  planned_route_id    String?                          @db.VarChar(36)
  actual_route_id     String?                          @db.VarChar(36)
  session_id          String?                          @db.VarChar(36)
  date                DateTime                         @db.Date
  session             route_comparisons_session
  user_id             String?                          @db.VarChar(36)
  route_id            String?                          @db.VarChar(36)
  planned_distance_km Float?                           @db.Float
  planned_time_hours  Float?                           @db.Float
  planned_start_time  DateTime?                        @db.DateTime(0)
  planned_num_stops   Int?
  planned_num_drivers Int?
  actual_distance_km  Float?                           @db.Float
  actual_time_hours   Float?                           @db.Float
  actual_start_time   DateTime?                        @db.DateTime(0)
  actual_num_stops    Int?
  actual_num_drivers  Int?
  distance_diff_km    Float?                           @db.Float
  time_diff_hours     Float?                           @db.Float
  efficiency_score    Float?                           @db.Float
  reward_signal       Float?                           @db.Float
  time_of_day         DateTime?                        @db.Time(0)
  day_of_week         Int?
  weather_condition   String?                          @db.VarChar(100)
  traffic_level       route_comparisons_traffic_level?
  model_updated       Boolean?                         @default(false)
  learned_route_saved Boolean?                         @default(false)
  created_at          DateTime?                        @default(now()) @db.Timestamp(0)
  updated_at          DateTime?                        @default(now()) @db.Timestamp(0)

  @@index([actual_route_id], map: "idx_actual_route")
  @@index([date, session], map: "idx_date_session")
  @@index([efficiency_score], map: "idx_efficiency")
  @@index([planned_route_id], map: "idx_planned_route")
  @@index([reward_signal], map: "idx_reward")
  @@index([route_id, user_id], map: "idx_route_driver")
}

model route_journey_summary {
  id                               String                           @id @db.VarChar(36)
  route_id                         String                           @db.VarChar(36)
  driver_id                        String?                          @db.VarChar(36)
  date                             DateTime                         @db.Date
  session                          route_journey_summary_session
  route_type                       route_journey_summary_route_type
  planned_start_time               DateTime?                        @db.DateTime(0)
  planned_depot_departure_time     DateTime?                        @db.DateTime(0)
  planned_end_time                 DateTime?                        @db.DateTime(0)
  planned_total_distance_km        Float?                           @db.Float
  planned_total_time_minutes       Float?                           @db.Float
  planned_num_stops                Int?
  planned_num_drivers              Int?
  planned_within_2_hour_constraint Boolean?                         @default(false)
  actual_start_time                DateTime?                        @db.DateTime(0)
  actual_depot_departure_time      DateTime?                        @db.DateTime(0)
  actual_end_time                  DateTime?                        @db.DateTime(0)
  actual_total_distance_km         Float?                           @db.Float
  actual_total_time_minutes        Float?                           @db.Float
  actual_num_stops                 Int?
  actual_num_drivers               Int?
  actual_within_2_hour_constraint  Boolean?                         @default(false)
  time_difference_minutes          Float?                           @db.Float
  distance_difference_km           Float?                           @db.Float
  efficiency_score                 Float?                           @db.Float
  is_best_route                    Boolean?                         @default(false)
  average_speed_kmh                Float?                           @db.Float
  total_service_time_minutes       Float?                           @db.Float
  total_travel_time_minutes        Float?                           @db.Float
  created_at                       DateTime?                        @default(now()) @db.Timestamp(0)
  updated_at                       DateTime?                        @default(now()) @db.Timestamp(0)

  @@index([is_best_route, date, session], map: "idx_best_route")
  @@index([date, session], map: "idx_date_session")
  @@index([driver_id], map: "idx_driver_id")
  @@index([route_id], map: "idx_route_id")
  @@index([route_type], map: "idx_route_type")
}

model route_stop_timing_details {
  id                                        String                                     @id @db.VarChar(36)
  route_id                                  String                                     @db.VarChar(36)
  planned_stop_id                           String?                                    @db.VarChar(36)
  actual_stop_id                            String?                                    @db.VarChar(36)
  stop_order                                Int
  date                                      DateTime                                   @db.Date
  session                                   route_stop_timing_details_session
  planned_arrival_time                      DateTime?                                  @db.DateTime(0)
  planned_departure_time                    DateTime?                                  @db.DateTime(0)
  planned_service_time_minutes              Float?                                     @db.Float
  planned_travel_time_from_previous_minutes Float?                                     @db.Float
  planned_cumulative_time_minutes           Float?                                     @db.Float
  actual_arrival_time                       DateTime?                                  @db.DateTime(0)
  actual_departure_time                     DateTime?                                  @db.DateTime(0)
  actual_service_time_minutes               Float?                                     @db.Float
  actual_travel_time_from_previous_minutes  Float?                                     @db.Float
  actual_cumulative_time_minutes            Float?                                     @db.Float
  arrival_time_difference_minutes           Float?                                     @db.Float
  service_time_difference_minutes           Float?                                     @db.Float
  travel_time_difference_minutes            Float?                                     @db.Float
  delivery_status                           route_stop_timing_details_delivery_status? @default(pending)
  created_at                                DateTime?                                  @default(now()) @db.Timestamp(0)
  updated_at                                DateTime?                                  @default(now()) @db.Timestamp(0)

  @@index([actual_stop_id], map: "idx_actual_stop")
  @@index([date, session], map: "idx_date_session")
  @@index([planned_stop_id], map: "idx_planned_stop")
  @@index([route_id], map: "idx_route_id")
  @@index([route_id, stop_order], map: "idx_stop_order")
}

model traffic_patterns {
  id                 String                   @id @db.VarChar(36)
  location_name      String?                  @db.VarChar(255)
  location_point     Unsupported("geometry")?
  latitude           Decimal?                 @db.Decimal(10, 8)
  longitude          Decimal?                 @db.Decimal(10, 8)
  radius_meters      Int?                     @default(500)
  start_hour         Int
  start_minute       Int?                     @default(0)
  end_hour           Int
  end_minute         Int?                     @default(0)
  days_of_week       String?                  @default("1,2,3,4,5") @db.VarChar(20)
  traffic_multiplier Decimal?                 @default(1.00) @db.Decimal(3, 2)
  delay_minutes      Int?                     @default(0)
  clears_at_hour     Int?
  clears_at_minute   Int?                     @default(0)
  description        String?                  @db.Text
  is_active          Boolean?                 @default(true)
  created_at         DateTime?                @default(now()) @db.DateTime(0)
  updated_at         DateTime?                @default(now()) @db.DateTime(0)

  @@index([is_active], map: "idx_is_active")
  @@index([latitude, longitude], map: "idx_location")
  @@index([start_hour, end_hour], map: "idx_time_range")
}

enum Status {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum UserStatus {
  ACTIVE
  BLOCKED
  INACTIVE
}

enum ProductStatus {
  ACTIVE
  INACTIVE
  OUT_OF_STOCK
  DISCONTINUED
}

enum MenuStatus {
  ACTIVE
  INACTIVE
  DRAFT
  PUBLISHED
}

enum AddressType {
  HOME
  OFFICE
  OTHER
}

enum OrderStatus {
  Pending
  Confirmed
  Cancelled
  Delivered
  Payment_Confirmed
  CUSTOMER_UNAVAILABLE
  
}

enum PaymentMethod {
  UPI
  CreditCard
  DebitCard
  NetBanking
}

enum PaymentStatus {
  Pending
  Confirmed
  Failed
}

enum ReceiptType {
  Image
  PDF
}

enum customer_subscriptions_morning_status {
  YES
  NO
}

enum customer_subscriptions_lunch_status {
  YES
  NO
}

enum customer_subscriptions_dinner_status {
  YES
  NO
}

enum traffic_weather_log_traffic_level {
  Low
  Medium
  High
}

enum actual_route_stops_status {
  OnTime
  Late
}

enum user_roles_name {
  ADMIN
  SELLER
  USER
  DELIVERY_EXECUTIVE
  DELIVERY_MANAGER
  CEO
  CFO
}

enum DeliveryExecutiveStatus {
  ACTIVE
  INACTIVE
}

enum best_planned_routes_session {
  breakfast
  lunch
  dinner
}

enum best_planned_routes_route_type {
  ai_optimized
  route_optimization
  google_maps
}

enum delivery_zones_zone_type {
  PRIMARY
  MEDIUM
  HIGH_DEMAND
  LOW_PRIORITY
}

enum actual_route_stops_session {
  breakfast
  lunch
  dinner
}

enum route_journey_summary_session {
  breakfast
  lunch
  dinner
}

enum route_comparisons_session {
  breakfast
  lunch
  dinner
}

enum route_journey_summary_route_type {
  ai_optimized
  route_optimization
  google_maps
}

enum route_stop_timing_details_session {
  breakfast
  lunch
  dinner
}

enum planned_route_stops_session {
  breakfast
  lunch
  dinner
}

enum planned_route_stops_route_type {
  ai_optimized
  route_optimization
  google_maps
}

enum vehicle_tracking_log_session {
  breakfast
  lunch
  dinner
}

enum route_stop_timing_details_delivery_status {
  pending
  arrived
  delivered
  missed
  cancelled
}

enum route_comparisons_traffic_level {
  low
  medium
  high
}

enum actual_route_stops_delivery_status {
  pending
  arrived
  delivered
  missed
  cancelled
}

enum actual_route_stops_route_type {
  ai_optimized
  route_optimization
  google_maps
}

enum delivery_items_delivery_time_slot {
  BREAKFAST 
  LUNCH
  DINNER
}
